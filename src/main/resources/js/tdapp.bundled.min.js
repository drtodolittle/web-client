(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0)})([function(module,exports,__webpack_require__){__webpack_require__(1);__webpack_require__(2);__webpack_require__(3);__webpack_require__(4);__webpack_require__(5);__webpack_require__(6);__webpack_require__(7)},function(module,exports){var tdapp=angular.module("tdapp",["satellizer","ngCookies","ngRoute"]);tdapp.config(function($authProvider,$routeProvider){$authProvider.baseUrl="/api/todos/";$authProvider.loginUrl="login";$routeProvider.when("/",{templateUrl:"login.html",controller:"AuthCtrl"}).when("/login",{templateUrl:"login.html",controller:"AuthCtrl"}).when("/working",{templateUrl:"working.html"}).when("/main",{templateUrl:"main.html",controller:"MainCtrl"}).when("/register",{templateUrl:"register.html",controller:"RegCtrl"}).when("/error",{templateUrl:"error.html"}).when("/egg",{templateUrl:"egg.html"}).otherwise({redirectTo:"/error"})});tdapp.value("appdata",{appname:"drtodolittle",appnick:"derdr",cookiename:"derdr",localserver:"http://localhost:3000/api/todos",server:window.location.origin+"/api/todos",userservice:window.location.origin+"/api/users"});module.exports=tdapp},function(module,exports,__webpack_require__){var tdapp=__webpack_require__(1);tdapp.factory("TDMgr",function(){var fact={};fact.todos=[];fact.tags=[];fact.checkForHashtag=function(obj){if(obj.topic==undefined){return}if(obj.topic.indexOf("#")>=0){var s=obj.topic.indexOf("#");if(s==-1)e=obj.topic.length;var e=obj.topic.indexOf(" ",s+1);if(e==-1)e=obj.topic.length;var tag=obj.topic.substring(s,e);if(tag=="#")tag=undefined;obj.tag=tag;if(tag!=undefined&&fact.tags.indexOf(tag)<0){fact.tags.push(tag)}}else{obj.tag=undefined}};fact.getTags=function(){return fact.tags};fact.getTodos=function(){return fact.todos};fact.getTodosByTag=function(tag,done){if(tag==""||tag=="All"){var ret=[];if(done){fact.todos.forEach(function(obj){if(obj.done){ret.push(obj)}})}else{fact.todos.forEach(function(obj){if(!obj.done){ret.push(obj)}})}return ret}var tagged=[];fact.todos.forEach(function(obj){if(obj.tag!=undefined&&obj.tag==tag){if(done){if(obj.done)tagged.push(obj)}else{if(!obj.done)tagged.push(obj)}}});return tagged};fact.setTodos=function(todolist){if(todolist==undefined)return;fact.todos=todolist;if(todolist.length>0){fact.todos.forEach(function(obj){fact.checkForHashtag(obj)})}};fact.clearTodos=function(){while(fact.todos.length>0){fact.todos.pop()}while(fact.tags.length>0){fact.tags.pop()}};fact.getTodoById=function(id){var ret=undefined;fact.todos.forEach(function(obj){if(obj.id==id){ret=obj}});return ret};fact.addTodoObj=function(obj){fact.checkForHashtag(obj);fact.todos.unshift(obj);return obj};fact.addTodo=function(topic){var obj={topic:topic,done:false};fact.addTodoObj(obj);return obj};fact.delTodo=function(item){var idx=fact.todos.indexOf(item);if(idx>=0){var tag=item.tag;fact.todos.splice(idx,1);if(tag!=undefined){var ttd=fact.getTodosByTag(tag);if(ttd.length==0){fact.tags.splice(fact.tags.indexOf(tag),1)}}}};fact.togDone=function(item){var idx=fact.todos.indexOf(item);if(idx<0)return;var todo=fact.todos[idx];if(todo.done){todo.done=false}else{todo.done=true}};return fact})},function(module,exports,__webpack_require__){var tdapp=__webpack_require__(1);tdapp.service("Autologin",function($http,$window,$location,$cookies,appdata,TDMgr,Backend){var _scope;this.setScope=function(scope){_scope=scope};this.check=function(){var token=$cookies.get(appdata.cookiename);if(token!=undefined){$location="/#/working";_scope.errormsg="";$http.defaults.headers.common["Authorization"]="Basic "+token;if($window.location.hostname=="localhost"){appdata.server=appdata.localserver}_scope.filtertag="All";Backend.getTodos();$location="/#/main"}else{if($location.$$url=="/main")$window.location="/#/login"}}})},function(module,exports,__webpack_require__){var tdapp=__webpack_require__(1);tdapp.service("Backend",function($http,$timeout,$window,$location,appdata,TDMgr){var _scope;this.setScope=function(scope){_scope=scope};this.postTodo=function(obj){$http({method:"post",url:appdata.server,header:"application/json",data:obj}).then(function successCallback(res){obj.id=res.data.id},function errorCallback(res){console.log("Error:"+JSON.stringify(res))})};this.putTodo=function(obj){$http({method:"put",url:appdata.server+"/"+obj.id,header:"application/json",data:obj}).then(function successCallback(res){},function errorCallback(res){console.log("Error:"+JSON.stringify(res))})};this.delTodo=function(obj){$http({method:"delete",url:appdata.server+"/"+obj.id,header:"application/json",data:obj}).then(function successCallback(res){},function errorCallback(res){console.log("Error:"+JSON.stringify(res))})};this.doneTodo=function(obj){$http({method:"get",url:appdata.server+"/"+obj.id+"/done"}).then(function successCallback(res){},function errorCallback(res){console.log("Error:"+JSON.stringify(res))})};this.getTodos=function(){$http({method:"get",url:appdata.server}).then(function successCallback(res){TDMgr.clearTodos();res.data.forEach(function(o){TDMgr.addTodoObj(o)});$timeout(function(){_scope.tags=TDMgr.getTags();_scope.todos=TDMgr.getTodosByTag(_scope.filtertag);$window.location="/#/main"},1e3);$timeout(function(){if(typeof window.orientation=="undefined"){$("#todotxta").blur().focus()}},1128)},function(res){console.log("Error:"+JSON.stringify(res));_scope.errormsg="Server not available!";_scope.dologout()})}})},function(module,exports,__webpack_require__){var tdapp=__webpack_require__(1);tdapp.controller("RegCtrl",function($scope,$http,$window,appdata){$scope.doRegister=function(){$http({method:"post",url:userservice,header:"application/json",data:$scope.user}).then(function successCallback(res){alert("Registration email sent. Please activate your account.");$window.location="/"},function errorCallback(res){console.log(JSON.stringify(res))})};$scope.registerKeydown=function(e){var k=e.keyCode;if(k==13){e.preventDefault();$scope.doRegister()}};$(".impressum").css("visibility","visible");$(".flash").css("visibility","visible");$("#liusername").focus()})},function(module,exports,__webpack_require__){var tdapp=__webpack_require__(1);tdapp.controller("AuthCtrl",function($scope,$http,$auth,$cookies,$window,appdata,TDMgr,Backend,Autologin){Autologin.setScope($scope);Backend.setScope($scope);$scope.authenticate=function(provider){$auth.authenticate(provider).then(function(res){if($auth.isAuthenticated){var dtok=jwt_decode(res.data.token);$scope.user={};$scope.user.id=dtok.sub}})};function locallogin(){$window.location="/#/working";appdata.server=appdata.localserver;var now=new Date;var exp=new Date(now.getFullYear(),now.getMonth()+1,now.getDate());$cookies.put(appdata.cookiename,"bla",{expires:exp});$scope.filtertag="All";Backend.getTodos();$(".fkts").css("visibility","visible");$scope.errormsg=""}$scope.dologin=function(){if($window.location.host=="localhost"){locallogin();return}$auth.login($scope.user).then(function(response){$window.location="/#/working";var now=new Date;var exp=new Date(now.getFullYear(),now.getMonth()+1,now.getDate());$cookies.put(appdata.cookiename,response.data.token,{expires:exp});$http.defaults.headers.common["Authorization"]="Basic "+response.data.token;$scope.filtertag="All";Backend.getTodos();$(".fkts").css("visibility","visible");$scope.errormsg=""}).catch(function(error){$scope.errormsg="Login-Error.";console.log(error)})};$scope.loginKeydown=function(e){var k=e.keyCode;if(k==13){e.preventDefault();$scope.dologin()}};$scope.showRegister=function(){$window.location="/#/register"};$(".flash").css("visibility","visible");$("#liusername").focus();Autologin.check()})},function(module,exports,__webpack_require__){var tdapp=__webpack_require__(1);tdapp.controller("MainCtrl",function($scope,$timeout,$interval,$http,$cookies,$window,appdata,TDMgr,Backend,Autologin){Autologin.setScope($scope);Backend.setScope($scope);$scope.showdone=false;$scope.showdonetext="Show Done";$scope.dologout=function(){$(".fkts").css("visibility","hidden");$(".todota").css("visibility","hidden");$(".todotab").css("visibility","hidden");$cookies.remove(appdata.cookiename);TDMgr.clearTodos();$window.location="/#/working";$timeout(function(){$window.location="/#/login"},1e3);$timeout(function(){$("#liusername").focus()},1128)};$scope.newtodoKeydown=function(e){var k=e.keyCode;if(k==13){e.preventDefault();if($scope.newtodotxt!=""){var newtodo={};newtodo.topic=$scope.newtodotxt;newtodo.done=false;$scope.newtodotxt="";Backend.postTodo(newtodo);TDMgr.addTodoObj(newtodo);if($scope.showdone){$scope.showdone=false;$scope.showdonetext="Show Done"}if(newtodo.tag!=undefined){$scope.filtertag=newtodo.tag}else{$scope.filtertag="All"}$scope.todos=TDMgr.getTodosByTag($scope.filtertag,$scope.showdone);window.scrollTo(0,0);$("#todotxta").focus()}}else if(k==9){e.preventDefault()}};$scope.todolineKeydown=function(e,id){var k=e.keyCode;if(k==13){e.preventDefault();var currentTodo=$("#todoid"+id);currentTodo.blur();var obj=TDMgr.getTodoById(id);if(obj!=undefined){obj.topic=currentTodo.html();Backend.putTodo(obj);var oldtag=obj.tag;TDMgr.checkForHashtag(obj);if(oldtag!=undefined){var ttd=TDMgr.getTodosByTag(oldtag);if(ttd.length<=0){TDMgr.tags.splice(TDMgr.tags.indexOf(oldtag),1)}}$scope.todos=TDMgr.getTodosByTag($scope.filtertag,$scope.showdone)}}};$scope.seltodoline=function(id){$("#todoid"+id).focus()};$scope.deltodo=function(obj){obj.deleted=true;Backend.delTodo(obj);TDMgr.delTodo(obj);$scope.todos=TDMgr.getTodosByTag($scope.filtertag,$scope.showdone)};$scope.togDone=function(obj){TDMgr.togDone(obj);Backend.doneTodo(obj);$scope.todos=TDMgr.getTodosByTag($scope.filtertag,$scope.showdone)};$scope.togShowdone=function(){$scope.showdone=!$scope.showdone;if($scope.showdone){$scope.showdonetext="Show Open"}else{$scope.showdonetext="Show Done"}$scope.todos=TDMgr.getTodosByTag($scope.filtertag,$scope.showdone)};$scope.getTodosByTag=TDMgr.getTodosByTag;$(".impressum").css("visibility","visible");$(".flash").css("visibility","visible");Autologin.check()})}]);